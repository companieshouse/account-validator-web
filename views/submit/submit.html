{% extends "layout.html" %}
{% from "govuk/components/file-upload/macro.njk" import govukFileUpload %}
{% from "govuk/components/notification-banner/macro.njk" import govukNotificationBanner %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}

{% block pageTitle %}
  XBRL Company Accounts Validator
{% endblock %}

<!-- No service name header-->
{% block header %}
    {{ govukHeader({
    homepageUrl: "https://www.gov.uk",
    containerClasses: "govuk-width-container"})
  }}
{% endblock %}

{% block backLink %}
    {# Go back to the start page #}
    {{ govukBackLink({
    text: "Back",
    href: Urls.BASE
    }) }}
{% endblock %}

{% block content %}
    <div id="submit" class="govuk-grid-row" aria-hidden="false">
        <div class="govuk-grid-column-two-thirds">
            <h1 class="govuk-heading-xl">
                Upload your accounts file
            </h1>

            {{ errorSummary() }}

            <form method="POST" enctype="multipart/form-data" action="{{Urls.SUBMIT}}">
                {{ govukFileUpload({
                    id: FILE_UPLOAD_FIELD_NAME,
                    name: FILE_UPLOAD_FIELD_NAME,
                    errorMessage: formValidationResult.getErrorForField(FILE_UPLOAD_FIELD_NAME),
                    label: {
                        text: "Upload your accounts file, then select continue."
                    }
                }) }}

                <p class="govuk-body">The validation process may take a few minutes.</p>

                {{ govukButton({
                    id: "submit-button",
                    text: "Validate",
                    type: "submit"
                }) }}
            </form>

            {# // TODO: remove this? #}
            <div id="progress"></div>
        </div>
    </div>

    <div id="pending" class="govuk-grid-row govuk-!-display-none" aria-hidden="true">
        {% include "result/account.validation.pending.html" %}
    </div>

    <script src="{{assetPath}}/javascripts/app/account-validation-web/file-upload.js"></script>
    <script>
        var resultsUrl = "{{Urls.RESULT}}";
        var errorUrl = "{{Urls.ERROR}}";
        var timeoutMessage = "{{timeoutMessage}}";
        var fileInputFieldName = "{{FILE_UPLOAD_FIELD_NAME}}";

        //@ts-ignore
        setupForm({resultsUrl, errorUrl, timeoutMessage, fileInputFieldName});
    </script>
{% endblock %}