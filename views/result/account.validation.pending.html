<div class="govuk-width-container gov-container-align-center word-break">
    
    <h1 class="govuk-heading-l govuk-text-align-centre">Validation in progress</h1>
    <p class="govuk-body govuk-!-font-weight-bold govuk-!-margin-bottom-8 govuk-text-align-centre"><span id="percentage">0</span>% complete</p>
    <p class="govuk-body govuk-text-align-centre">This page will automatically update when the validation is complete.</p>  

    <div class="gds-loading-icon-container">
        <div class="spinner"></div>
    </div>
</div>

<script defer>
    const eventSource = new EventSource("{{Urls.RESULT}}/{{fileId}}/sse/{{sseId}}");

    eventSource.addEventListener('message', (event) => {
        const data = JSON.parse(event.data);
        document.getElementById('percentage').innerText = data.message.percent;

        if(data.message.percent === 100){
            location.reload();
            eventSource.close();
            this.removeListener('message', () => console.log("Removed Listener"));
        }
    });
</script>